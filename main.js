/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target, mod));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MyPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var import_electron = require("electron");
var path = __toESM(require("path"));
var os = __toESM(require("os"));
var DEFAULT_SETTINGS = {
  rootFolder: "~/",
  findString: "",
  replaceString: ""
};
var MyPlugin = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new RootFolderURISettingTab(this.app, this));
    this.addCommand({
      id: "add-root-folder-uri",
      name: "Add a root folder URI.",
      callback: () => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
        if (view === null) {
          return;
        }
        const document = view.editor;
        setTimeout(() => {
          const files = import_electron.remote.dialog.showOpenDialogSync({ properties: ["openFile", "openDirectory", "multiSelections"] });
          if (files === void 0) {
            return;
          }
          for (const file of files) {
            const relative2 = path.relative(this.settings.rootFolder.replace(/^~(?=$|\/|\\)/, os.homedir()), file).replace(this.settings.findString, this.settings.replaceString);
            const line = document.getCursor();
            document.replaceRange(`[${path.basename(file)}](obsidian://from-root?to=${encodeURI(relative2)})`, line, line);
          }
        }, 50);
      }
    });
    this.registerObsidianProtocolHandler("from-root", async (payload) => {
      const parameters = payload;
      const file = path.resolve(this.settings.rootFolder.replace(/^~(?=$|\/|\\)/, os.homedir()), decodeURI(parameters.to));
      import_electron.shell.openPath(file).then((err) => err === "" || new import_obsidian.Notice(err));
    });
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var RootFolderURISettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Root Folder URI Settings" });
    new import_obsidian.Setting(containerEl).setName("Root Folder").setDesc("The folder from which the `ob-root` URI schema rooted.").addText((text) => text.setPlaceholder("The folder path should end with a slash (/).").setValue(this.plugin.settings.rootFolder).onChange(async (value) => {
      this.plugin.settings.rootFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Find String").setDesc("The string (or RegExp) to search in the relative path.").addText((text) => text.setValue(this.plugin.settings.findString).onChange(async (value) => {
      this.plugin.settings.findString = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Replace String").setDesc("The string to replace in the relative path.").addText((text) => text.setValue(this.plugin.settings.replaceString).onChange(async (value) => {
      this.plugin.settings.replaceString = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBNYXJrZG93blZpZXcsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBPYnNpZGlhblByb3RvY29sRGF0YSB9IGZyb20gJ29ic2lkaWFuJ1xuaW1wb3J0IHsgcmVtb3RlLCBzaGVsbCB9IGZyb20gJ2VsZWN0cm9uJ1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0ICogYXMgb3MgZnJvbSAnb3MnXG5cbi8vIFJlbWVtYmVyIHRvIHJlbmFtZSB0aGVzZSBjbGFzc2VzIGFuZCBpbnRlcmZhY2VzIVxuXG5pbnRlcmZhY2UgUm9vdEZvbGRlclVSSVNldHRpbmdzIHtcblx0cm9vdEZvbGRlcjogc3RyaW5nXG5cdGZpbmRTdHJpbmc6IHN0cmluZ1xuXHRyZXBsYWNlU3RyaW5nOiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIFJvb3RGb2xkZXJVUklQYXJhbXMgZXh0ZW5kcyBPYnNpZGlhblByb3RvY29sRGF0YSB7XG5cdHRvOiBzdHJpbmdcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogUm9vdEZvbGRlclVSSVNldHRpbmdzID0ge1xuXHRyb290Rm9sZGVyOiAnfi8nLFxuXHRmaW5kU3RyaW5nOiAnJyxcblx0cmVwbGFjZVN0cmluZzogJydcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTXlQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuXHRzZXR0aW5nczogUm9vdEZvbGRlclVSSVNldHRpbmdzXG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKClcblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgUm9vdEZvbGRlclVSSVNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKVxuXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnYWRkLXJvb3QtZm9sZGVyLXVyaScsXG5cdFx0XHRuYW1lOiAnQWRkIGEgcm9vdCBmb2xkZXIgVVJJLicsXG5cdFx0XHRjYWxsYmFjazogKCkgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuXHRcdFx0XHRpZiAodmlldyA9PT0gbnVsbCkge1xuXHRcdFx0XHRcdHJldHVyblxuXHRcdFx0XHR9XG5cdFx0XHRcdGNvbnN0IGRvY3VtZW50ID0gdmlldy5lZGl0b3Jcblx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgZmlsZXMgPSByZW1vdGUuZGlhbG9nLnNob3dPcGVuRGlhbG9nU3luYyh7cHJvcGVydGllczogWydvcGVuRmlsZScsICdvcGVuRGlyZWN0b3J5JywgJ211bHRpU2VsZWN0aW9ucyddfSlcblx0XHRcdFx0XHRpZiAoZmlsZXMgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuXHRcdFx0XHRcdFx0Y29uc3QgcmVsYXRpdmUgPSBwYXRoXG5cdFx0XHRcdFx0XHRcdC5yZWxhdGl2ZSh0aGlzLnNldHRpbmdzLnJvb3RGb2xkZXIucmVwbGFjZSgvXn4oPz0kfFxcL3xcXFxcKS8sIG9zLmhvbWVkaXIoKSksIGZpbGUpXG5cdFx0XHRcdFx0XHRcdC5yZXBsYWNlKHRoaXMuc2V0dGluZ3MuZmluZFN0cmluZywgdGhpcy5zZXR0aW5ncy5yZXBsYWNlU3RyaW5nKVxuXHRcdFx0XHRcdFx0Y29uc3QgbGluZSA9IGRvY3VtZW50LmdldEN1cnNvcigpXG5cdFx0XHRcdFx0XHRkb2N1bWVudC5yZXBsYWNlUmFuZ2UoYFske3BhdGguYmFzZW5hbWUoZmlsZSl9XShvYnNpZGlhbjovL2Zyb20tcm9vdD90bz0ke2VuY29kZVVSSShyZWxhdGl2ZSl9KWAsIGxpbmUsIGxpbmUpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCA1MClcblx0XHRcdH1cblx0XHR9KVxuXHRcdFxuXHRcdHRoaXMucmVnaXN0ZXJPYnNpZGlhblByb3RvY29sSGFuZGxlcignZnJvbS1yb290JywgYXN5bmMgKHBheWxvYWQpID0+IHtcblx0XHRcdGNvbnN0IHBhcmFtZXRlcnMgPSBwYXlsb2FkIGFzIFJvb3RGb2xkZXJVUklQYXJhbXNcblx0XHRcdGNvbnN0IGZpbGUgPSBwYXRoLnJlc29sdmUodGhpcy5zZXR0aW5ncy5yb290Rm9sZGVyLnJlcGxhY2UoL15+KD89JHxcXC98XFxcXCkvLCBvcy5ob21lZGlyKCkpLCBkZWNvZGVVUkkocGFyYW1ldGVycy50bykpXG5cdFx0XHRzaGVsbC5vcGVuUGF0aChmaWxlKS50aGVuKGVyciA9PiBlcnIgPT09ICcnIHx8IG5ldyBOb3RpY2UoZXJyKSlcblx0XHR9KVxuXHR9XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpXG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKVxuXHR9XG59XG5cbmNsYXNzIFJvb3RGb2xkZXJVUklTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHBsdWdpbjogTXlQbHVnaW5cblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBNeVBsdWdpbikge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKVxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luXG5cdH1cblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGNvbnN0IHtjb250YWluZXJFbH0gPSB0aGlzXG5cblx0XHRjb250YWluZXJFbC5lbXB0eSgpXG5cblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ1Jvb3QgRm9sZGVyIFVSSSBTZXR0aW5ncyd9KVxuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnUm9vdCBGb2xkZXInKVxuXHRcdFx0LnNldERlc2MoJ1RoZSBmb2xkZXIgZnJvbSB3aGljaCB0aGUgYG9iLXJvb3RgIFVSSSBzY2hlbWEgcm9vdGVkLicpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdUaGUgZm9sZGVyIHBhdGggc2hvdWxkIGVuZCB3aXRoIGEgc2xhc2ggKC8pLicpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yb290Rm9sZGVyKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Mucm9vdEZvbGRlciA9IHZhbHVlXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKClcblx0XHRcdFx0fSkpXG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdGaW5kIFN0cmluZycpXG5cdFx0XHQuc2V0RGVzYygnVGhlIHN0cmluZyAob3IgUmVnRXhwKSB0byBzZWFyY2ggaW4gdGhlIHJlbGF0aXZlIHBhdGguJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZmluZFN0cmluZylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbmRTdHJpbmcgPSB2YWx1ZVxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpXG5cdFx0XHRcdH0pKVxuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnUmVwbGFjZSBTdHJpbmcnKVxuXHRcdFx0LnNldERlc2MoJ1RoZSBzdHJpbmcgdG8gcmVwbGFjZSBpbiB0aGUgcmVsYXRpdmUgcGF0aC4nKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXBsYWNlU3RyaW5nKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucmVwbGFjZVN0cmluZyA9IHZhbHVlXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKClcblx0XHRcdFx0fSkpXG5cdH1cbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBQW1HO0FBQ25HLHNCQUE4QjtBQUM5QixXQUFzQjtBQUN0QixTQUFvQjtBQWNwQixJQUFNLG1CQUEwQztBQUFBLEVBQy9DLFlBQVk7QUFBQSxFQUNaLFlBQVk7QUFBQSxFQUNaLGVBQWU7QUFDaEI7QUFFQSxJQUFxQixXQUFyQixjQUFzQyx1QkFBTztBQUFBLEVBRzVDLE1BQU0sU0FBUztBQUNkLFVBQU0sS0FBSyxhQUFhO0FBRXhCLFNBQUssY0FBYyxJQUFJLHdCQUF3QixLQUFLLEtBQUssSUFBSSxDQUFDO0FBRTlELFNBQUssV0FBVztBQUFBLE1BQ2YsSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNO0FBQ2YsY0FBTSxPQUFPLEtBQUssSUFBSSxVQUFVLG9CQUFvQiw0QkFBWTtBQUNoRSxZQUFJLFNBQVMsTUFBTTtBQUNsQjtBQUFBLFFBQ0Q7QUFDQSxjQUFNLFdBQVcsS0FBSztBQUN0QixtQkFBVyxNQUFNO0FBQ2hCLGdCQUFNLFFBQVEsdUJBQU8sT0FBTyxtQkFBbUIsRUFBQyxZQUFZLENBQUMsWUFBWSxpQkFBaUIsaUJBQWlCLEVBQUMsQ0FBQztBQUM3RyxjQUFJLFVBQVUsUUFBVztBQUN4QjtBQUFBLFVBQ0Q7QUFDQSxxQkFBVyxRQUFRLE9BQU87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
